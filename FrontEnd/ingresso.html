<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Adquira seu ingresso</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'DM Sans', sans-serif;
      height: 90vh;
    }

    .navbar-brand img {
      height: 30px;
    }

    .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='black' stroke-width='2' stroke-linecap='round' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

    .titulo {
    display: flex;
    margin: 0.75rem;
    margin-top: 1rem;
}

    h3 {
    padding-left: 0.5rem;
    font-size: 2rem;
    font-weight: 700;
    line-height: 1.4;
    }

.divider {
  height: 1px;
  background-color: #e3e3e3;
  margin: 0.5rem;  
  margin-top: 0.25rem;
}

    .event-info {
      display: flex;
      gap: 1rem;
      align-items: center;
      margin: 1.5rem;
    }

    .event-info img {
      width: 90px;
      height: 90px;
      border-radius: 10px;
      object-fit: cover;
    }

    .event-details h5 {
      font-weight: 700;
      margin-bottom: 0;
    }

    .event-details p {
      margin: 0;
      color: #b9b9b9;
    }

    .card-section {
      background-color: #000;
      border: 1px solid #ffffff;
      border-radius: 8px;
      padding: 1rem;
      margin: 1.5rem;
    }

    .card-section h6 {
      font-weight: 600;
      border-bottom: 1px solid #ffffff;
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }

    .item-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .item-line .price {
      font-weight: 600;
    }

    .counter {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .counter button {
      border: none;
      background-color: #00ff84;
      color: #000;
      font-weight: 700;
      width: 28px;
      height: 28px;
      border-radius: 6px;
    }

    .total-box {
        display: flex;
        justify-content: center;
        padding: 0;
        margin: 0;
        margin-bottom: 3.5rem;
    }
    .total-input {
      background-color: #ffffff;
      border-radius: 8px;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      font-weight: 700;
      font-size: 1rem;
      color: #000;
      width: 85%;
    }

    .btn-cart {
      background-color: #24D301;
      color: #000;
      font-weight: 600;
      width: 90%;
      max-width: 350px;
      border-radius: 8px;
      padding: 0.75rem;
      display: block;
      margin: 1rem auto;
    }

    .btn-cart:hover {
      background-color: #2ff500;
      color: #000;
    }
  </style>
</head>
<body>

  <nav class="navbar navbar-dark" style="background-color: #24D301;">
  <div class="container-fluid d-flex justify-content-between align-items-center ms-1 me-1">

    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuLateral" aria-controls="menuLateral">
      <span class="navbar-toggler-icon"></span>
    </button>

    <a class="navbar-brand fw-bold text-dark" href="#">
      <img src="./assets/img/logo.png" alt="Logo" height="30">
    </a>

    <div class="d-flex align-items-center gap-3">
  <a href="carrinho.html" class="text-dark position-relative" aria-label="Abrir carrinho">
    <i class="bi bi-cart3 fs-2"></i>
    <span id="cart-count-badge"
          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
          style="display:none; font-size:.7rem; min-width:1.1rem; height:1.1rem; padding:0; line-height:1.1rem;">
      0
    </span>
  </a>
  <a href="conta.html" class="text-dark" aria-label="Minha conta">
    <i class="bi bi-person-circle fs-2"></i>
  </a>
</div>
</nav>

<div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="menuLateral" aria-labelledby="menuLateralLabel">
  <div class="offcanvas-header">
    <h2 class="offcanvas-title" id="menuLateralLabel">Menu</h2>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
  </div>
  <div class="menu-divider"></div>
  <div class="offcanvas-body">
    <ul class="list-unstyled">
      <li><a href="index.html" class="text-white text-decoration-none d-block py-2">Eventos</a></li>
      <li><a href="sobre.html" class="text-white text-decoration-none d-block py-2">Sobre Nós</a></li>
      <li><a href="#" class="text-white text-decoration-none d-block py-2">Conta</a></li>
      <li><a href="#" class="text-white text-decoration-none d-block py-2">Sair</a></li>
    </ul>
    <div class="d-flex justify-content-start gap-4 mt-3">
  <a href="#" class="text-white fs-1"><i class="bi bi-instagram"></i></a>
  <a href="#" class="text-white fs-1"><i class="bi bi-tiktok"></i></a>
  <a href="#" class="text-white fs-1"><i class="bi bi-whatsapp"></i></a>
</div>
  </div>
</div>

<section class="titulo">
<a href="index.html" class="text-white fs-2 text-decoration-none p-1"><i class="bi bi-arrow-left"></i></a>
<h3 class="title fw-bold mb-0">Adquira seu ingresso</h3>
</section>

<div class="divider mb-4"></div>

  <div class="event-info">
    <img id="evento-img" src="./assets/img/banner-ArvoreDaVida.png" alt="Árvore da Vida">
    <div class="event-details">
      <h5 id="nome-evento"></h5>
      <p id="local-evento"></p>
      <p id="data-evento"></p>
    </div>
  </div>

  <div class="card-section">
    <h6>Ingresso do Evento</h6>
    <div class="item-line">
      <span id="nome-ingresso-evento"></span>
      <div class="d-flex align-items-center gap-3">
        <span id="preco-ingresso-evento" class="price"></span>
        <div class="counter">
          <button>-</button>
          <span>1</span>
          <button>+</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card-section">
    <h6>Ingresso da Excursão</h6>
    <div class="item-line">
      <span id="nome-excursao-evento"></span>
      <div class="d-flex align-items-center gap-3">
        <span id="preco-excursao-evento" class="price"></span>
        <div class="counter">
          <button>-</button>
          <span>1</span>
          <button>+</button>
        </div>
      </div>
    </div>
  </div>

   <div class="total-box">
  <div class="total-input">
    <span>Total:</span>
    <span id="preco-total"></span>
  </div>
  </div>

  <button class="btn btn-cart">Adicionar ao Carrinho</button>


  <script>
    const eventos = {
      "mandallah": {
        nome: "Mandallah - 20 anos",
        local: "Itirapina - SP",
        data: "15/10",
        imagem: "./assets/img/banner-Mandallah.png",
        ingresso: { nome: "Ingresso Mandallah", preco: 180 },
        excursao: { nome: "Excursão Mandallah", preco: 100 }
      },

      "trance-legalize": {
        nome: "Trance Legalize",
        local: "Rio Claro - SP",
        data: "02/11",
        imagem: "./assets/img/banner-TranceLegalize.png",
        ingresso: { nome: "Ingresso Trance Legalize", preco: 120 },
        excursao: { nome: "Excursão Trance Legalize", preco: 80 }
      },

      "arvore-da-vida": {
        nome: "Árvore da Vida",
        local: "Itirapina - SP",
        data: "15/11",
        imagem: "./assets/img/banner-ArvoreDaVida.png",
        ingresso: { nome: "Ingresso Árvore da Vida", preco: 150 },
        excursao: { nome: "Excursão Árvore da Vida", preco: 95 }
      },

      "psy-festival": {
        nome: "PSY Festival",
        local: "Sumaré - SP",
        data: "03/12",
        imagem: "./assets/img/banner-PSY.png",
        ingresso: { nome: "Ingresso PSY Festival", preco: 150 },
        excursao: { nome: "Excursão PSY Festival", preco: 95 }
      },

       "shanti-festival": {
        nome: "Shanti Festival",
        local: "Mariporã - SP",
        data: "24/01",
        imagem: "./assets/img/banner-ShantiFestival.png",
        ingresso: { nome: "Ingresso Shanti Festival", preco: 150 },
        excursao: { nome: "Excursão Shanti Festival", preco: 95 }
      },

      "shiva-shankar": {
        nome: "Shiva Shankar",
        local: "Rio Claro - SP",
        data: "07/03",
        imagem: "./assets/img/banner-ShivaShankar.png",
        ingresso: { nome: "Ingresso Shiva Shankar", preco: 150 },
        excursao: { nome: "Excursão Shiva Shankar", preco: 95 }
      },

      "flor-da-vida": {
        nome: "Flor da Vida",
        local: "Itirapina - SP",
        data: "21/03",
        imagem: "./assets/img/banner-FlorDaVida.png",
        ingresso: { nome: "Ingresso Flor da Vida", preco: 150 },
        excursao: { nome: "Excursão Flor da Vida", preco: 95 }
      },

      "yanomami-festival": {
        nome: "Yanomami Festival",
        local: "Itirapina - SP",
        data: "20/05",
        imagem: "./assets/img/banner-YanomamiFestival.png",
        ingresso: { nome: "Ingresso Yanomami Festival", preco: 150 },
        excursao: { nome: "Excursão Yanomami Festival", preco: 95 }
      },
    };

    const params = new URLSearchParams(window.location.search);
    const eventoParam = params.get("evento");

    const evento = eventos[eventoParam];

    if (evento) {
      document.getElementById("evento-img").src = evento.imagem;
      document.getElementById("nome-evento").textContent = evento.nome;
      document.getElementById("local-evento").textContent = evento.local;
      document.getElementById("data-evento").textContent = evento.data;
      document.getElementById("nome-ingresso-evento").textContent = evento.ingresso.nome;
      document.getElementById("preco-ingresso-evento").textContent = `R$${evento.ingresso.preco},00`;
      document.getElementById("nome-excursao-evento").textContent = evento.excursao.nome;
      document.getElementById("preco-excursao-evento").textContent = `R$${evento.excursao.preco},00`;
      document.getElementById("preco-total").textContent = `R$${evento.ingresso.preco + evento.excursao.preco},00`;
    } else {
      document.body.innerHTML = "<h3 class='text-center mt-5'>Evento não encontrado.</h3>";
    }
  </script>

  <script>
  const CART_KEY = 'cart:v1';

  const money = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });

  const CartStore = {
    load() {
      try { return JSON.parse(localStorage.getItem(CART_KEY)) || { items: [] }; }
      catch { return { items: [] }; }
    },
    save(state) {
      state.updatedAt = new Date().toISOString();
      localStorage.setItem(CART_KEY, JSON.stringify(state));
    },
    clear() {
      localStorage.removeItem(CART_KEY);
    }
  };

  function calcTotal(items) {
    return items.reduce((acc, it) => acc + (it.unitPrice * it.qty), 0);
  }

  const sections = document.querySelectorAll('.card-section');
  const ingressoSection = sections[0];
  const excursaoSection  = sections[1];

  function setupCounter(section) {
    const btns = section.querySelectorAll('.counter button');
    const qtySpan = section.querySelector('.counter span');

    function setQty(n) {
      const v = Math.max(0, n);
      qtySpan.textContent = String(v);
      updateTotal();
    }

    btns[0].addEventListener('click', () => setQty(parseInt(qtySpan.textContent, 10) - 1));
    btns[1].addEventListener('click', () => setQty(parseInt(qtySpan.textContent, 10) + 1));
  }

  setupCounter(ingressoSection);
  setupCounter(excursaoSection);

  const totalSpan = document.getElementById('preco-total');

  function getQty(section) {
    return parseInt(section.querySelector('.counter span').textContent, 10);
  }

  function updateTotal() {
    const qIngress = getQty(ingressoSection);
    const qExcurs  = getQty(excursaoSection);
    const total = (evento.ingresso.preco * qIngress) + (evento.excursao.preco * qExcurs);
    totalSpan.textContent = money.format(total);
  }
  updateTotal();

  document.querySelector('.btn.btn-cart').addEventListener('click', () => {
    const qIngress = getQty(ingressoSection);
    const qExcurs  = getQty(excursaoSection);

    const items = [];
    if (qIngress > 0) {
      items.push({
        id: `event:${eventoParam}:ingresso`,
        eventoId: eventoParam,
        name: document.getElementById('nome-ingresso-evento').textContent.trim(),
        unitPrice: Number(evento.ingresso.preco),
        qty: qIngress,
        kind: 'ingresso'
      });
    }
    if (qExcurs > 0) {
      items.push({
        id: `event:${eventoParam}:excursao`,
        eventoId: eventoParam,
        name: document.getElementById('nome-excursao-evento').textContent.trim(),
        unitPrice: Number(evento.excursao.preco),
        qty: qExcurs,
        kind: 'excursao'
      });
    }

    if (!items.length) {
      alert('Selecione pelo menos 1 item para adicionar ao carrinho.');
      return;
    }

    const state = CartStore.load();
    for (const it of items) {
      const existing = state.items.find(x => x.id === it.id);
      if (existing) existing.qty += it.qty;
      else state.items.push(it);
    }
    state.total = calcTotal(state.items);
    if (!state.currency) state.currency = 'BRL';
    if (!state.createdAt) state.createdAt = new Date().toISOString();

    CartStore.save(state);

    window.location.href = 'carrinho.html';
  });
</script>

<script>
(function () {
  const CART_KEY = 'cart:v1';
  const badgeEl = document.getElementById('cart-count-badge');
  if (!badgeEl) return;

  function getCount() {
    try {
      const state = JSON.parse(localStorage.getItem(CART_KEY) || '{"items":[]}');
      return (state.items || []).reduce((sum, it) => sum + (parseInt(it.qty, 10) || 0), 0);
    } catch { return 0; }
  }

  function renderBadge() {
    const n = getCount();
    badgeEl.textContent = n;
    badgeEl.style.display = n > 0 ? 'inline-block' : 'none';
  }

  renderBadge();
  window.addEventListener('storage', (e) => { if (e.key === CART_KEY) renderBadge(); });

  if (window.CartStore && typeof window.CartStore.save === 'function') {
    const originalSave = window.CartStore.save.bind(window.CartStore);
    window.CartStore.save = function (state) {
      const r = originalSave(state);
      renderBadge();
      return r;
    };
  }

  window.updateCartCountBadge = renderBadge;
})();
</script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
